<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Plumed 2.0: developer manual: colvar/RMSD.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="../pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <img src="../logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../user-doc/html/index.html"> <img src="../developer-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Plumed 2.0: developer manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_522821243a246e1e3c6d050e57ed13f6.html">colvar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RMSD.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="colvar_2_r_m_s_d_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   Copyright (c) 2013 The plumed team</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   (see the PEOPLE file at the root of the distribution for a list of names)</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   See http://www.plumed-code.org for more information.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   This file is part of plumed, version 2.0.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   plumed is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">   plumed is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">   GNU Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">   You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">   along with plumed.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="colvar_2_colvar_8h.html">Colvar.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;core/PlumedMain.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="colvar_2_action_register_8h.html">ActionRegister.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;tools/PDB.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;tools/RMSD.h&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;core/Atoms.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_p_l_m_d.html">PLMD</a>{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span>colvar{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html">   35</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html">RMSD</a> : <span class="keyword">public</span> <a class="code" href="class_p_l_m_d_1_1_colvar.html">Colvar</a> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a158b0089692a21be7f6e205280d26b88">   37</a></span>&#160;  <a class="code" href="class_p_l_m_d_1_1_r_m_s_d.html">PLMD::RMSD</a> <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a158b0089692a21be7f6e205280d26b88">rmsd</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#afa061621f2d8c0463594c36f33e9e274">   39</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#afa061621f2d8c0463594c36f33e9e274">squared</a>; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">   41</a></span>&#160;  vector&lt;Vector&gt; <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">derivs</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html">RMSD</a>(<span class="keyword">const</span> <a class="code" href="class_p_l_m_d_1_1_action_options.html">ActionOptions</a>&amp;);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> calculate();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> registerKeywords(<a class="code" href="class_p_l_m_d_1_1_keywords.html">Keywords</a>&amp; keys);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;};</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//+PLUMEDOC COLVAR RMSD</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">Calculate the RMSD with respect to a reference structure.  </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">To calculate the root-mean-square deviation between the atoms in two configurations</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">you must first superimpose the two structures in some ways.  Obviously, it is the internal vibrational </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">motions of the structure - i.e. not the translations and rotations - that are interesting.  It is </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">possible to align two structures (i.e. remove the translational and rotational motions of the </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">system).</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">In general the aim of this colvar is to calculate something like:</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">d(X,X_r) = \vert X-X&#39; \vert </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">where \f$ X \f$ is the molecular dynamics snapshot and   </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\f$ X&#39; \f$ is a reference structure you provide as input.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">Here the symbols \f$ \vert \dots \vert \f$ represent some sort of norm of choice that is selected through the OPTIMAL switch (see below for examples).</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">Here we discuss the switch we implemented so far.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">       - If you use TYPE=SIMPLE you just calculate the root mean square deviation after reset of the geometric center  </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">         that reads:</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">         \f[</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">         d(X,X_r) = \sqrt{ \sum_i \sum_\alpha^{x,y,z}  \frac{w_i}{\sum_j w_j}( X_{i,\alpha}-com_\alpha(X)-{X&#39;}_{i,\alpha}+com_\alpha(X&#39;) )^2 } </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">         \f]</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">         with </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">         \f[</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">         com_\alpha(X)= \sum_i  \frac{w&#39;_{i}}{\sum_j w&#39;_j}X_{i,\alpha}</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">         \f]</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">         and</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">         \f[</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">         com_\alpha(X&#39;)= \sum_i  \frac{w&#39;_{i}}{\sum_j w&#39;_j}X&#39;_{i,\alpha}</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">         \f]</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">         where  \f$ com_\alpha(X) \f$ and  \f$ com_\alpha(X&#39;) \f$  are the center of mass</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">         whenever the weights $w&#39;$ are assigned proportional to the atomic masses, otherwise are the geometric centers of the </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">         running MD snapshot and the reference frame respectively whenever they are all set to one.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">         Note that two set of weights exist:  \f$ w&#39; \f$ and  \f$ w \f$. The first is used to calculate the center of mass (so it determines the \e alignment) </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">         and the second is used to calculate the actual \e displacement.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">         These are assigned in the reference (that you set with e.g.: REFERENCE=whatever.pdb) </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">         frame which is, for this case, a simple pdb file containing the atoms</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">         on which you want to calculate the distance. </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">         Note that in this pdb you need to set correctly the index of the atom STARTING FROM 1 (i.e. +1 shift respect </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">         to VMD numbering) so that the program knows which atom needs to be compared with.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">         The OCCUPANCY column (the first after the coordinates) set the \f$ w&#39;  \f$ used for the center of mass calculation and the BETA column (the second</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">         after the Cartesian coordinates) set the \f$ w \f$ which is responsible of the calculation of the displacement. </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">         Users can also use fractional values for beta and the occupancy values. We recommend you only do this when you really know what you are doing however as the results can be rather strange. </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">         In PDB files the atomic coordinates and box lengths should be in Angstroms unless </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">         you are working with natural units.  If you are working with natural units then the coordinates </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">         should be in your natural length unit.  For more details on the PDB file format visit http://www.wwpdb.org/docs.html</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">         .</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">       - If you use TYPE=OPTIMAL you just the root mean square deviation after reset of the geometric center  </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> and performing an optimal alignment that reads:</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">        \f[</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">         d(X,X_r) = \sqrt{ \sum_i \sum_\alpha^{x,y,z}  \frac{w_i}{\sum_j w_j}[ X_{i,\alpha}-com_\alpha(X)- \sum_\beta M(X,X&#39;,w&#39;)_{\alpha,\beta}({X&#39;}_{i,\beta}-com_\beta(X&#39;)) ]^2 } </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">        \f]</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">        where \f$ M(X,X&#39;,w&#39;) \f$ is the optimal alignment matrix which is calculated through the Kearsley \cite kearsley algorithm and the set of </span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">        weights used for the alignment of the center of mass is also used to perform the optimal alignment.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">        Note that the flexibility of setting only certain atoms to calculate the center of mass and optimal alignment which may be different from the one used in the \e displacemnt  calculation is useful whenever for example you want to calculate the motion of a ligand in a protein cavity and you want to clearly use the protein as reference system.  </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">        When this form of RMSD is used to calculate the secondary structure variables (\ref ALPHARMSD, \ref ANTIBETARMSD and \ref PARABETARMSD) all the atoms in the segment are assumed to be part of both the alignment and displacement sets.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">\par Examples</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">The following tells plumed to calculate the RMSD distance between</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">the positions of the atoms in the reference file and their instantaneous</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">position.  The Kearseley algorithm is used so this is done optimally.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\verbatim</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">RMSD REFERENCE=file.pdb TYPE=OPTIMAL</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">\endverbatim</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">...</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">//+ENDPLUMEDOC</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;PLUMED_REGISTER_ACTION(<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html">RMSD</a>,<span class="stringliteral">&quot;RMSD&quot;</span>)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a56caaa9f454ac68a5af387a0acadc8f3">  130</a></span>&#160;void <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html">RMSD</a>::registerKeywords(<a class="code" href="class_p_l_m_d_1_1_keywords.html">Keywords</a>&amp; keys){</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  Colvar::registerKeywords(keys);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  keys.add(<span class="stringliteral">&quot;compulsory&quot;</span>,<span class="stringliteral">&quot;REFERENCE&quot;</span>,<span class="stringliteral">&quot;a file in pdb format containing the reference structure and the atoms involved in the CV.&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  keys.add(<span class="stringliteral">&quot;compulsory&quot;</span>,<span class="stringliteral">&quot;TYPE&quot;</span>,<span class="stringliteral">&quot;SIMPLE&quot;</span>,<span class="stringliteral">&quot;the manner in which RMSD alignment is performed.  Should be OPTIMAL or SIMPLE.&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  keys.addFlag(<span class="stringliteral">&quot;SQUARED&quot;</span>,<span class="keyword">false</span>,<span class="stringliteral">&quot; This should be setted if you want MSD instead of RMSD &quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#aa306a39e26950d9d8625b26efd65ccb0">  137</a></span>&#160;RMSD::RMSD(<span class="keyword">const</span> <a class="code" href="class_p_l_m_d_1_1_action_options.html">ActionOptions</a>&amp;ao):</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<a class="code" href="core_2_colvar_8h.html#aa95e2f515fc3d4e1693bfa2f0199a971">PLUMED_COLVAR_INIT</a>(ao),rmsd(log),squared(false)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">string</span> reference;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#ae0c8ed07593b5e242e34b32e0edc3a12">parse</a>(<span class="stringliteral">&quot;REFERENCE&quot;</span>,reference);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">string</span> type;  </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  type.assign(<span class="stringliteral">&quot;SIMPLE&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#ae0c8ed07593b5e242e34b32e0edc3a12">parse</a>(<span class="stringliteral">&quot;TYPE&quot;</span>,type);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#a5540be9c95bc8bf9f1ec567c047afddb">parseFlag</a>(<span class="stringliteral">&quot;SQUARED&quot;</span>,<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#afa061621f2d8c0463594c36f33e9e274">squared</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#a8ffc4538dce6f51e1505a0a300d204e2">checkRead</a>();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action_with_value.html#a21d7521c7a5da4065b67904c809067b7">addValueWithDerivatives</a>(); <a class="code" href="class_p_l_m_d_1_1_action_with_value.html#a8eb10877f2789470a248586484fca62c">setNotPeriodic</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_p_d_b.html">PDB</a> pdb;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// read everything in ang and transform to nm if we are not in natural units</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">if</span>( !pdb.<a class="code" href="class_p_l_m_d_1_1_p_d_b.html#ac5a722ba63319312391ad41f9f02bb41">read</a>(reference,<a class="code" href="structplumed.html">plumed</a>.getAtoms().usingNaturalUnits(),0.1/<a class="code" href="class_p_l_m_d_1_1_action_atomistic.html#a0f46760435a7aa0933fba5f38c17ae4e">atoms</a>.<a class="code" href="class_p_l_m_d_1_1_atoms.html#aeef6a637d1d180177b1f8517e0e45777">getUnits</a>().<a class="code" href="class_p_l_m_d_1_1_units.html#a984aaa6be69ad033940259303451a74a">getLength</a>()) )</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="class_p_l_m_d_1_1_action.html#a94c1c30fbc92747b8828aa6f1e3d207d">error</a>(<span class="stringliteral">&quot;missing input file &quot;</span> + reference );</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a158b0089692a21be7f6e205280d26b88">rmsd</a>.<a class="code" href="class_p_l_m_d_1_1_r_m_s_d.html#a6fb43eb760b28e87a938f7c96b21fc30">set</a>(pdb,type);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_colvar.html#af1bb03650fe9aec207af6b6bee87316b">requestAtoms</a>(pdb.<a class="code" href="class_p_l_m_d_1_1_p_d_b.html#a90553bb50dfe6b31a6c57d9f5a87ecfb">getAtomNumbers</a>());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">derivs</a>.resize(<a class="code" href="class_p_l_m_d_1_1_action_atomistic.html#a7d0c94f88e93c9ffa208af8b8fbef6cb">getNumberOfAtoms</a>());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#a31215215cfe4b1078c8f566688964346">log</a>.<a class="code" href="class_p_l_m_d_1_1_o_file.html#a1ad29d0ba5b7ceb7c1949f33c6ccd29f">printf</a>(<span class="stringliteral">&quot;  reference from file %s\n&quot;</span>,reference.c_str());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#a31215215cfe4b1078c8f566688964346">log</a>.<a class="code" href="class_p_l_m_d_1_1_o_file.html#a1ad29d0ba5b7ceb7c1949f33c6ccd29f">printf</a>(<span class="stringliteral">&quot;  which contains %d atoms\n&quot;</span>,<a class="code" href="class_p_l_m_d_1_1_action_atomistic.html#a7d0c94f88e93c9ffa208af8b8fbef6cb">getNumberOfAtoms</a>());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action.html#a31215215cfe4b1078c8f566688964346">log</a>.<a class="code" href="class_p_l_m_d_1_1_o_file.html#a1ad29d0ba5b7ceb7c1949f33c6ccd29f">printf</a>(<span class="stringliteral">&quot;  method for alignment : %s \n&quot;</span>,<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a158b0089692a21be7f6e205280d26b88">rmsd</a>.<a class="code" href="class_p_l_m_d_1_1_r_m_s_d.html#ad244ec1d2b67c95f07451e018082364a">getMethod</a>().c_str() );</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#afa061621f2d8c0463594c36f33e9e274">squared</a>)<a class="code" href="class_p_l_m_d_1_1_action.html#a31215215cfe4b1078c8f566688964346">log</a>.<a class="code" href="class_p_l_m_d_1_1_o_file.html#a1ad29d0ba5b7ceb7c1949f33c6ccd29f">printf</a>(<span class="stringliteral">&quot;  chosen to use SQUARED option for MSD instead of RMSD\n&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">// calculator</span></div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a5bc9abc7d15f5d3dd23d9fd314d8653a">  171</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a5bc9abc7d15f5d3dd23d9fd314d8653a">RMSD::calculate</a>(){</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">double</span> r=<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a158b0089692a21be7f6e205280d26b88">rmsd</a>.<a class="code" href="class_p_l_m_d_1_1_r_m_s_d.html#a318b55d7f450ca4f065f02825b033f5a">calculate</a>(<a class="code" href="class_p_l_m_d_1_1_action_atomistic.html#a92af051ca17a0c89e1d32fe9d4e203e8">getPositions</a>(),<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">derivs</a>,<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#afa061621f2d8c0463594c36f33e9e274">squared</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_action_with_value.html#adf1a88b3916a1512b44b15c3011d75b1">setValue</a>(r);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">derivs</a>.size();i++) <a class="code" href="class_p_l_m_d_1_1_colvar.html#aa19fdcbe9b9be274ed87d9600d43f6f7">setAtomsDerivatives</a>(i,<a class="code" href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">derivs</a>[i]);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_tensor_generic.html">Tensor</a> <a class="code" href="class_p_l_m_d_1_1_action_atomistic.html#ac9d7b542602cedd270056900881a4254">virial</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="class_p_l_m_d_1_1_colvar.html#ac548174fb4e8b595e93a8b48f6ac41a0">setBoxDerivativesNoPbc</a>();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="ttc" id="colvar_2_colvar_8h_html"><div class="ttname"><a href="colvar_2_colvar_8h.html">Colvar.h</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_p_d_b_html_ac5a722ba63319312391ad41f9f02bb41"><div class="ttname"><a href="class_p_l_m_d_1_1_p_d_b.html#ac5a722ba63319312391ad41f9f02bb41">PLMD::PDB::read</a></div><div class="ttdeci">bool read(const std::string &amp;file, bool naturalUnits, double scale)</div><div class="ttdoc">Read the pdb from a file, scaling positions by a factor scale. </div><div class="ttdef"><b>Definition:</b> <a href="_p_d_b_8cpp_source.html#l00144">PDB.cpp:144</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_html_a5540be9c95bc8bf9f1ec567c047afddb"><div class="ttname"><a href="class_p_l_m_d_1_1_action.html#a5540be9c95bc8bf9f1ec567c047afddb">PLMD::Action::parseFlag</a></div><div class="ttdeci">void parseFlag(const std::string &amp;key, bool &amp;t)</div><div class="ttdoc">Parse one keyword as boolean flag. </div><div class="ttdef"><b>Definition:</b> <a href="_action_8cpp_source.html#l00104">Action.cpp:104</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_with_value_html_a8eb10877f2789470a248586484fca62c"><div class="ttname"><a href="class_p_l_m_d_1_1_action_with_value.html#a8eb10877f2789470a248586484fca62c">PLMD::ActionWithValue::setNotPeriodic</a></div><div class="ttdeci">void setNotPeriodic()</div><div class="ttdoc">Set your default value to have no periodicity. </div><div class="ttdef"><b>Definition:</b> <a href="_action_with_value_8cpp_source.html#l00107">ActionWithValue.cpp:107</a></div></div>
<div class="ttc" id="colvar_2_action_register_8h_html"><div class="ttname"><a href="colvar_2_action_register_8h.html">ActionRegister.h</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_html_a31215215cfe4b1078c8f566688964346"><div class="ttname"><a href="class_p_l_m_d_1_1_action.html#a31215215cfe4b1078c8f566688964346">PLMD::Action::log</a></div><div class="ttdeci">Log &amp; log</div><div class="ttdoc">Reference to the log stream. </div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_8h_source.html#l00093">Action.h:93</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_tensor_generic_html"><div class="ttname"><a href="class_p_l_m_d_1_1_tensor_generic.html">PLMD::TensorGeneric</a></div><div class="ttdoc">Class implementing fixed size matrices of doubles. </div><div class="ttdef"><b>Definition:</b> <a href="tools_2_tensor_8h_source.html#l00070">Tensor.h:70</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1colvar_1_1_r_m_s_d_html_ac7933046b18658e43cd7447fe5a9c654"><div class="ttname"><a href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#ac7933046b18658e43cd7447fe5a9c654">PLMD::colvar::RMSD::derivs</a></div><div class="ttdeci">vector&lt; Vector &gt; derivs</div><div class="ttdef"><b>Definition:</b> <a href="colvar_2_r_m_s_d_8cpp_source.html#l00041">RMSD.cpp:41</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_colvar_html_aa19fdcbe9b9be274ed87d9600d43f6f7"><div class="ttname"><a href="class_p_l_m_d_1_1_colvar.html#aa19fdcbe9b9be274ed87d9600d43f6f7">PLMD::Colvar::setAtomsDerivatives</a></div><div class="ttdeci">void setAtomsDerivatives(int, const Vector &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="core_2_colvar_8h_source.html#l00097">Colvar.h:97</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_html_a94c1c30fbc92747b8828aa6f1e3d207d"><div class="ttname"><a href="class_p_l_m_d_1_1_action.html#a94c1c30fbc92747b8828aa6f1e3d207d">PLMD::Action::error</a></div><div class="ttdeci">void error(const std::string &amp;msg) const </div><div class="ttdoc">Crash calculation and print documentation. </div><div class="ttdef"><b>Definition:</b> <a href="_action_8cpp_source.html#l00195">Action.cpp:195</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_atomistic_html_a92af051ca17a0c89e1d32fe9d4e203e8"><div class="ttname"><a href="class_p_l_m_d_1_1_action_atomistic.html#a92af051ca17a0c89e1d32fe9d4e203e8">PLMD::ActionAtomistic::getPositions</a></div><div class="ttdeci">const std::vector&lt; Vector &gt; &amp; getPositions() const </div><div class="ttdoc">Get the array of all positions. </div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_atomistic_8h_source.html#l00158">ActionAtomistic.h:158</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_html_a8ffc4538dce6f51e1505a0a300d204e2"><div class="ttname"><a href="class_p_l_m_d_1_1_action.html#a8ffc4538dce6f51e1505a0a300d204e2">PLMD::Action::checkRead</a></div><div class="ttdeci">void checkRead()</div><div class="ttdoc">Check if Action was properly read. </div><div class="ttdef"><b>Definition:</b> <a href="_action_8cpp_source.html#l00161">Action.cpp:161</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_with_value_html_a21d7521c7a5da4065b67904c809067b7"><div class="ttname"><a href="class_p_l_m_d_1_1_action_with_value.html#a21d7521c7a5da4065b67904c809067b7">PLMD::ActionWithValue::addValueWithDerivatives</a></div><div class="ttdeci">void addValueWithDerivatives()</div><div class="ttdoc">Add a value with the name label that has derivatives. </div><div class="ttdef"><b>Definition:</b> <a href="_action_with_value_8cpp_source.html#l00102">ActionWithValue.cpp:102</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_r_m_s_d_html"><div class="ttname"><a href="class_p_l_m_d_1_1_r_m_s_d.html">PLMD::RMSD</a></div><div class="ttdoc">A class that implements RMSD calculations This is a class that implements the various infrastructure ...</div><div class="ttdef"><b>Definition:</b> <a href="tools_2_r_m_s_d_8h_source.html#l00062">RMSD.h:62</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_r_m_s_d_html_a318b55d7f450ca4f065f02825b033f5a"><div class="ttname"><a href="class_p_l_m_d_1_1_r_m_s_d.html#a318b55d7f450ca4f065f02825b033f5a">PLMD::RMSD::calculate</a></div><div class="ttdeci">double calculate(const std::vector&lt; Vector &gt; &amp;positions, std::vector&lt; Vector &gt; &amp;derivatives, bool squared=false)</div><div class="ttdoc">Compute rmsd. </div><div class="ttdef"><b>Definition:</b> <a href="tools_2_r_m_s_d_8cpp_source.html#l00131">RMSD.cpp:131</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_colvar_html_af1bb03650fe9aec207af6b6bee87316b"><div class="ttname"><a href="class_p_l_m_d_1_1_colvar.html#af1bb03650fe9aec207af6b6bee87316b">PLMD::Colvar::requestAtoms</a></div><div class="ttdeci">void requestAtoms(const std::vector&lt; AtomNumber &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="_colvar_8cpp_source.html#l00044">Colvar.cpp:44</a></div></div>
<div class="ttc" id="core_2_colvar_8h_html_aa95e2f515fc3d4e1693bfa2f0199a971"><div class="ttname"><a href="core_2_colvar_8h.html#aa95e2f515fc3d4e1693bfa2f0199a971">PLUMED_COLVAR_INIT</a></div><div class="ttdeci">#define PLUMED_COLVAR_INIT(ao)</div><div class="ttdef"><b>Definition:</b> <a href="core_2_colvar_8h_source.html#l00029">Colvar.h:29</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1colvar_1_1_r_m_s_d_html_a5bc9abc7d15f5d3dd23d9fd314d8653a"><div class="ttname"><a href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a5bc9abc7d15f5d3dd23d9fd314d8653a">PLMD::colvar::RMSD::calculate</a></div><div class="ttdeci">virtual void calculate()</div><div class="ttdoc">Calculate an Action. </div><div class="ttdef"><b>Definition:</b> <a href="colvar_2_r_m_s_d_8cpp_source.html#l00171">RMSD.cpp:171</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_html_ae0c8ed07593b5e242e34b32e0edc3a12"><div class="ttname"><a href="class_p_l_m_d_1_1_action.html#ae0c8ed07593b5e242e34b32e0edc3a12">PLMD::Action::parse</a></div><div class="ttdeci">void parse(const std::string &amp;key, T &amp;t)</div><div class="ttdoc">Parse one keyword as generic type. </div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_8h_source.html#l00273">Action.h:273</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_keywords_html"><div class="ttname"><a href="class_p_l_m_d_1_1_keywords.html">PLMD::Keywords</a></div><div class="ttdoc">This class holds the keywords and their documentation. </div><div class="ttdef"><b>Definition:</b> <a href="tools_2_keywords_8h_source.html#l00036">Keywords.h:36</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_options_html"><div class="ttname"><a href="class_p_l_m_d_1_1_action_options.html">PLMD::ActionOptions</a></div><div class="ttdoc">This class is used to bring the relevant information to the Action constructor. </div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_8h_source.html#l00041">Action.h:41</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_atomistic_html_a0f46760435a7aa0933fba5f38c17ae4e"><div class="ttname"><a href="class_p_l_m_d_1_1_action_atomistic.html#a0f46760435a7aa0933fba5f38c17ae4e">PLMD::ActionAtomistic::atoms</a></div><div class="ttdeci">Atoms &amp; atoms</div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_atomistic_8h_source.html#l00059">ActionAtomistic.h:59</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_atomistic_html_ac9d7b542602cedd270056900881a4254"><div class="ttname"><a href="class_p_l_m_d_1_1_action_atomistic.html#ac9d7b542602cedd270056900881a4254">PLMD::ActionAtomistic::virial</a></div><div class="ttdeci">Tensor virial</div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_atomistic_8h_source.html#l00048">ActionAtomistic.h:48</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_o_file_html_a1ad29d0ba5b7ceb7c1949f33c6ccd29f"><div class="ttname"><a href="class_p_l_m_d_1_1_o_file.html#a1ad29d0ba5b7ceb7c1949f33c6ccd29f">PLMD::OFile::printf</a></div><div class="ttdeci">int printf(const char *fmt,...)</div><div class="ttdoc">Formatted output with explicit format - a la printf. </div><div class="ttdef"><b>Definition:</b> <a href="_o_file_8cpp_source.html#l00082">OFile.cpp:82</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_colvar_html"><div class="ttname"><a href="class_p_l_m_d_1_1_colvar.html">PLMD::Colvar</a></div><div class="ttdoc">This is the abstract base class to use for implementing new collective variables, within it there is ...</div><div class="ttdef"><b>Definition:</b> <a href="core_2_colvar_8h_source.html#l00039">Colvar.h:39</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_with_value_html_adf1a88b3916a1512b44b15c3011d75b1"><div class="ttname"><a href="class_p_l_m_d_1_1_action_with_value.html#adf1a88b3916a1512b44b15c3011d75b1">PLMD::ActionWithValue::setValue</a></div><div class="ttdeci">void setValue(const double &amp;d)</div><div class="ttdoc">Set the default value (the one without name) </div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_with_value_8h_source.html#l00183">ActionWithValue.h:183</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1colvar_1_1_r_m_s_d_html_a158b0089692a21be7f6e205280d26b88"><div class="ttname"><a href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#a158b0089692a21be7f6e205280d26b88">PLMD::colvar::RMSD::rmsd</a></div><div class="ttdeci">PLMD::RMSD rmsd</div><div class="ttdef"><b>Definition:</b> <a href="colvar_2_r_m_s_d_8cpp_source.html#l00037">RMSD.cpp:37</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_r_m_s_d_html_a6fb43eb760b28e87a938f7c96b21fc30"><div class="ttname"><a href="class_p_l_m_d_1_1_r_m_s_d.html#a6fb43eb760b28e87a938f7c96b21fc30">PLMD::RMSD::set</a></div><div class="ttdeci">void set(const PDB &amp;, std::string mytype)</div><div class="ttdoc">set reference, align and displace from input pdb structure </div><div class="ttdef"><b>Definition:</b> <a href="tools_2_r_m_s_d_8cpp_source.html#l00065">RMSD.cpp:65</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_p_d_b_html"><div class="ttname"><a href="class_p_l_m_d_1_1_p_d_b.html">PLMD::PDB</a></div><div class="ttdoc">Minimalistic pdb parser. </div><div class="ttdef"><b>Definition:</b> <a href="tools_2_p_d_b_8h_source.html#l00038">PDB.h:38</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1colvar_1_1_r_m_s_d_html_afa061621f2d8c0463594c36f33e9e274"><div class="ttname"><a href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html#afa061621f2d8c0463594c36f33e9e274">PLMD::colvar::RMSD::squared</a></div><div class="ttdeci">bool squared</div><div class="ttdef"><b>Definition:</b> <a href="colvar_2_r_m_s_d_8cpp_source.html#l00039">RMSD.cpp:39</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_colvar_html_ac548174fb4e8b595e93a8b48f6ac41a0"><div class="ttname"><a href="class_p_l_m_d_1_1_colvar.html#ac548174fb4e8b595e93a8b48f6ac41a0">PLMD::Colvar::setBoxDerivativesNoPbc</a></div><div class="ttdeci">void setBoxDerivativesNoPbc()</div><div class="ttdoc">Set box derivatives automatically. </div><div class="ttdef"><b>Definition:</b> <a href="core_2_colvar_8h_source.html#l00107">Colvar.h:107</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_atoms_html_aeef6a637d1d180177b1f8517e0e45777"><div class="ttname"><a href="class_p_l_m_d_1_1_atoms.html#aeef6a637d1d180177b1f8517e0e45777">PLMD::Atoms::getUnits</a></div><div class="ttdeci">const Units &amp; getUnits()</div><div class="ttdef"><b>Definition:</b> <a href="core_2_atoms_8h_source.html#l00181">Atoms.h:181</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_units_html_a984aaa6be69ad033940259303451a74a"><div class="ttname"><a href="class_p_l_m_d_1_1_units.html#a984aaa6be69ad033940259303451a74a">PLMD::Units::getLength</a></div><div class="ttdeci">const double &amp; getLength() const </div><div class="ttdoc">Get length units as double. </div><div class="ttdef"><b>Definition:</b> <a href="tools_2_units_8h_source.html#l00095">Units.h:95</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1colvar_1_1_r_m_s_d_html"><div class="ttname"><a href="class_p_l_m_d_1_1colvar_1_1_r_m_s_d.html">PLMD::colvar::RMSD</a></div><div class="ttdoc">Provides the keyword RMSD  </div><div class="ttdef"><b>Definition:</b> <a href="colvar_2_r_m_s_d_8cpp_source.html#l00035">RMSD.cpp:35</a></div></div>
<div class="ttc" id="structplumed_html"><div class="ttname"><a href="structplumed.html">plumed</a></div><div class="ttdoc">Main plumed object. </div><div class="ttdef"><b>Definition:</b> <a href="wrapper_2_plumed_8h_source.html#l00201">Plumed.h:201</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_p_d_b_html_a90553bb50dfe6b31a6c57d9f5a87ecfb"><div class="ttname"><a href="class_p_l_m_d_1_1_p_d_b.html#a90553bb50dfe6b31a6c57d9f5a87ecfb">PLMD::PDB::getAtomNumbers</a></div><div class="ttdeci">const std::vector&lt; AtomNumber &gt; &amp; getAtomNumbers() const </div><div class="ttdoc">Access to the indexes. </div><div class="ttdef"><b>Definition:</b> <a href="_p_d_b_8cpp_source.html#l00047">PDB.cpp:47</a></div></div>
<div class="ttc" id="namespace_p_l_m_d_html"><div class="ttname"><a href="namespace_p_l_m_d.html">PLMD</a></div><div class="ttdef"><b>Definition:</b> <a href="_analysis_8cpp_source.html#l00030">Analysis.cpp:30</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_action_atomistic_html_a7d0c94f88e93c9ffa208af8b8fbef6cb"><div class="ttname"><a href="class_p_l_m_d_1_1_action_atomistic.html#a7d0c94f88e93c9ffa208af8b8fbef6cb">PLMD::ActionAtomistic::getNumberOfAtoms</a></div><div class="ttdeci">unsigned getNumberOfAtoms() const </div><div class="ttdoc">Get number of available atoms. </div><div class="ttdef"><b>Definition:</b> <a href="core_2_action_atomistic_8h_source.html#l00088">ActionAtomistic.h:88</a></div></div>
<div class="ttc" id="class_p_l_m_d_1_1_r_m_s_d_html_ad244ec1d2b67c95f07451e018082364a"><div class="ttname"><a href="class_p_l_m_d_1_1_r_m_s_d.html#ad244ec1d2b67c95f07451e018082364a">PLMD::RMSD::getMethod</a></div><div class="ttdeci">std::string getMethod()</div><div class="ttdef"><b>Definition:</b> <a href="tools_2_r_m_s_d_8cpp_source.html#l00102">RMSD.cpp:102</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<table align="center" frame="void" width="98%" cellpadding="2%">
<tr><td align="left" valign="center"> 
Hosted by GitHub &nbsp;
<a href="http://github.com"><img src="Octocat.png" width="88" height="66"  alt="GitHub Logo" /></a>
<!--Generated by  &#160; --> <a href="http://www.doxygen.org/index.html">
</td><td width=90% align="right">
<img class="footer" src="doxygen.png" alt="doxygen" align="right"/>
</a> 1.8.8
</td> </tr> 
</table>
</small></address>
</body>
</html>
