<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Plumed 2.0: user manual: RMSD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="../pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <img src="../logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="../user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Plumed 2.0: user manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home&#160;(v2.0)</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="tutorials.html"><span>How-tos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Introduction</a></li><li class="navelem"><a class="el" href="_colvar.html">Collective Variables</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RMSD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Calculate the RMSD with respect to a reference structure.</p>
<p>To calculate the root-mean-square deviation between the atoms in two configurations you must first superimpose the two structures in some ways. Obviously, it is the internal vibrational motions of the structure - i.e. not the translations and rotations - that are interesting. It is possible to align two structures (i.e. remove the translational and rotational motions of the system). In general the aim of this colvar is to calculate something like:</p>
<p class="formulaDsp">
\[ d(X,X_r) = \vert X-X&#39; \vert \]
</p>
<p>where \( X \) is the molecular dynamics snapshot and \( X&#39; \) is a reference structure you provide as input. Here the symbols \( \vert \dots \vert \) represent some sort of norm of choice that is selected through the OPTIMAL switch (see below for examples).</p>
<p>Here we discuss the switch we implemented so far.</p>
<ul>
<li>If you use TYPE=SIMPLE you just calculate the root mean square deviation after reset of the geometric center that reads: <p class="formulaDsp">
\[ d(X,X_r) = \sqrt{ \sum_i \sum_\alpha^{x,y,z} \frac{w_i}{\sum_j w_j}( X_{i,\alpha}-com_\alpha(X)-{X&#39;}_{i,\alpha}+com_\alpha(X&#39;) )^2 } \]
</p>
 with <p class="formulaDsp">
\[ com_\alpha(X)= \sum_i \frac{w&#39;_{i}}{\sum_j w&#39;_j}X_{i,\alpha} \]
</p>
 and <p class="formulaDsp">
\[ com_\alpha(X&#39;)= \sum_i \frac{w&#39;_{i}}{\sum_j w&#39;_j}X&#39;_{i,\alpha} \]
</p>
 where \( com_\alpha(X) \) and \( com_\alpha(X&#39;) \) are the center of mass whenever the weights $w'$ are assigned proportional to the atomic masses, otherwise are the geometric centers of the running MD snapshot and the reference frame respectively whenever they are all set to one. Note that two set of weights exist: \( w&#39; \) and \( w \). The first is used to calculate the center of mass (so it determines the <em>alignment</em>) and the second is used to calculate the actual <em>displacement</em>. These are assigned in the reference (that you set with e.g.: REFERENCE=whatever.pdb) frame which is, for this case, a simple pdb file containing the atoms on which you want to calculate the distance. Note that in this pdb you need to set correctly the index of the atom STARTING FROM 1 (i.e. +1 shift respect to VMD numbering) so that the program knows which atom needs to be compared with. The OCCUPANCY column (the first after the coordinates) set the \( w&#39; \) used for the center of mass calculation and the BETA column (the second after the Cartesian coordinates) set the \( w \) which is responsible of the calculation of the displacement. Users can also use fractional values for beta and the occupancy values. We recommend you only do this when you really know what you are doing however as the results can be rather strange. In PDB files the atomic coordinates and box lengths should be in Angstroms unless you are working with natural units. If you are working with natural units then the coordinates should be in your natural length unit. For more details on the PDB file format visit <a href="http://www.wwpdb.org/docs.html">http://www.wwpdb.org/docs.html</a></li>
</ul>
<ul>
<li>If you use TYPE=OPTIMAL you just the root mean square deviation after reset of the geometric center and performing an optimal alignment that reads: <p class="formulaDsp">
\[ d(X,X_r) = \sqrt{ \sum_i \sum_\alpha^{x,y,z} \frac{w_i}{\sum_j w_j}[ X_{i,\alpha}-com_\alpha(X)- \sum_\beta M(X,X&#39;,w&#39;)_{\alpha,\beta}({X&#39;}_{i,\beta}-com_\beta(X&#39;)) ]^2 } \]
</p>
 where \( M(X,X&#39;,w&#39;) \) is the optimal alignment matrix which is calculated through the Kearsley <a class="el" href="citelist.html#CITEREF_kearsley">[7]</a> algorithm and the set of weights used for the alignment of the center of mass is also used to perform the optimal alignment. Note that the flexibility of setting only certain atoms to calculate the center of mass and optimal alignment which may be different from the one used in the <em>displacemnt</em> calculation is useful whenever for example you want to calculate the motion of a ligand in a protein cavity and you want to clearly use the protein as reference system. When this form of RMSD is used to calculate the secondary structure variables (<a class="el" href="_a_l_p_h_a_r_m_s_d.html">ALPHARMSD</a>, <a class="el" href="_a_n_t_i_b_e_t_a_r_m_s_d.html">ANTIBETARMSD</a> and <a class="el" href="_p_a_r_a_b_e_t_a_r_m_s_d.html">PARABETARMSD</a>) all the atoms in the segment are assumed to be part of both the alignment and displacement sets.</li>
</ul>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> REFERENCE </b> </td><td>a file in pdb format containing the reference structure and the atoms involved in the CV.   </td></tr>
<tr>
<td width="15%"><b> TYPE </b> </td><td>( default=SIMPLE ) the manner in which RMSD alignment is performed. Should be OPTIMAL or SIMPLE.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SQUARED </b> </td><td><p class="starttd">( default=off ) This should be setted if you want MSD instead of RMSD  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following tells plumed to calculate the RMSD distance between the positions of the atoms in the reference file and their instantaneous position. The Kearseley algorithm is used so this is done optimally.</p>
<pre class="fragment">RMSD REFERENCE=file.pdb TYPE=OPTIMAL
</pre><p>... </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<table align="center" frame="void" width="98%" cellpadding="2%">
<tr><td align="left" valign="center"> 
Hosted by GitHub &nbsp;
<a href="http://github.com"><img src="Octocat.png" width="88" height="66"  alt="GitHub Logo" /></a>
<!--Generated by  &#160; --> <a href="http://www.doxygen.org/index.html">
</td><td width=90% align="right">
<img class="footer" src="doxygen.png" alt="doxygen" align="right"/>
</a> 1.8.8
</td> </tr> 
</table>
</small></address>
</body>
</html>
